<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<!-- Mirrored from docs.garagegames.com/tgea/official/content/documentation/Engine Overview/Scene3D.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Dec 2017 21:36:10 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<HEAD><SCRIPT SRC="../../include/tutorial.js" LANGUAGE="JavaScript"></SCRIPT>
<SCRIPT SRC="../../include/prototype.js" LANGUAGE="JavaScript"></SCRIPT>
<SCRIPT SRC="../../include/scriptaculous.js" LANGUAGE="JavaScript"></SCRIPT>
<SCRIPT SRC="../../include/glossaryLookUp.html" LANGUAGE="JavaScript"></SCRIPT>
<SCRIPT SRC="../../include/referenceLookUp.html" LANGUAGE="JavaScript"></SCRIPT>
<SCRIPT SRC="../../include/component.js" LANGUAGE="JavaScript"></SCRIPT>
<SCRIPT SRC="../../include/componentContainer.html" LANGUAGE="JavaScript"></SCRIPT>
<SCRIPT>DocImagePath = "../../index.html";</SCRIPT><link href="../../include/tutorialStyles.css" rel="stylesheet" type="text/css" />
<link href="../../include/tutorial.css" rel="stylesheet" type="text/css" />
<link href="../../include/globalMainPageStyles.css" rel="stylesheet" type="text/css" />
<link href="../../include/referenceThemeStyle.html" rel="stylesheet" type="text/css" />
<link href="../../include/docTheme/theme.css" rel="stylesheet" type="text/css" />
<script>
   // this script chunk is to update the ToC to the current doc and expand it
   pageID = 13;
   parent.leftFrame.expandToItem('tree2', 'doc13');
   var element = parent.leftFrame.document.getElementById('doc13');
   if((element) && (element.className==parent.leftFrame.nodeClosedClass))
{
   element.className = parent.leftFrame.nodeOpenClass
}
;
</script><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>3D Scene Management</title>
<link href="torque.css" rel="stylesheet" type="text/css">
</head>
<BODY id = "BODYID" onLoad = "initComponent()"  bgcolor="#ffffff" text="#000000" link="#333399" alink="#9999ff" vlink="#000066">
<div align="center">

<table width=700 cellspacing=0 cellpadding=10 border=0 bgcolor="#ffffff" summary="">
<tr><td>


<!-- Generated by Doxygen 1.5.4 -->
<h1><a class="anchor" name="Render3D"></a><a name = "HeaderLink0"></a><a name = "HeaderLink0"></a><a name = "HeaderLink0"></a>3D Scene Management </h1><h2><a class="anchor" name="3DSceneOver"></a><a name = "HeaderLink1"></a><a name = "HeaderLink1"></a><a name = "HeaderLink1"></a>Overview</h2>
Torque has a modular, extensible 3D world system. Subclasses of the <a class="el" href="../Engine%20Reference/a00541.html">GuiTSCtrl</a> override the GuiTSCtrl::processCameraQuery() and GuiTSCtrl::renderWorld() methods to define the camera orientation/FOV, and draw the 3D scene using the GFX system. GuiTSCtrl manages setting up the viewport, modelview matrix and projection matrix. The Torque example code <a class="el" href="../Engine%20Reference/a00340.html">GameTSCtrl</a> class calls the global functions GameProcessCameraQuery() and GameRenderWorld(). GameProcessCameraQuery() returns the viewing camera of the current control object (the object in the simulation that the player is currently controlling), then GameRenderWorld makes the client scene graph object render the world.
<h2><a class="anchor" name="Render3DSceneGraph"></a><a name = "HeaderLink2"></a><a name = "HeaderLink2"></a><a name = "HeaderLink2"></a>SceneGraph</h2>
The scene graph library (engine/sceneGraph) is, on the client, responsible for traversing the world scene and determining which objects in the world should be rendered given the current camera position, and on the server, determines what objects should be sent to each client based on that client's position in the world.<p>
The world in the <a class="el" href="../Engine%20Reference/a00914.html">SceneGraph</a> is divided into zones - volumes of space bounded by solid areas and portals. The outside world is a single zone, while interior objects can have multiple interior zones. SceneGraph::findZone() finds the zone of a given 3D point and reports which <a class="el" href="../Engine%20Reference/a00920.html" title="A 3D object.">SceneObject</a> owns that zone. SceneGraph::rezoneObject() determines which zone or zones contain a SceneObject instance. At render time, the scene is traversed starting from the zone that contains the camera, clipping each zone's objects to the visible portal set from the zones before it. Scoping of network objects is performed in SceneGraph::scopeScene().
<p>
The scene graph traversal is complicated by transform portals. Transform portals are objects like mirrors or teleporters through which the world can be viewed using a different transform than the normal camera transform. When SceneGraph::buildSceneTree() encounters an object with a transform portal, it constructs a new <a class="el" href="../Engine%20Reference/a00924.html" title="The SceneState describes the state of the scene being rendered.">SceneState</a> object for rendering that portal's contents.
<p>
Every renderable world object in the scene derives from the SceneObject base class. As the world is traversed, visible objects are asked to prepare for rendering in accordance with the GFX system, and if it should render, prepare a RenderInstance which is returned to the GFX system.  Render Instances are sorted based on both scene and batching criteria, and then delivered to the video card. This system allows, for example, an interior object with multiple translucent windows to render the building first, followed by other objects, followed by the building's windows. Objects can insert any number of images for rendering.
<h2><a class="anchor" name="Render3DEnvironment"></a><a name = "HeaderLink3"></a><a name = "HeaderLink3"></a><a name = "HeaderLink3"></a>Environment</h2>
<p></p>The environmental systems are the home for objects that render the outside world, including instances of the <a class="el" href="../Engine%20Reference/a01088.html">Sky</a>, <a class="el" href="../Engine%20Reference/a01141.html">TerrainBlock</a> and <a class="el" href="../Engine%20Reference/a01242.html">WaterBlock</a> classes.</p>
<h3><a class="anchor" name="Render3DSky"></a><a name = "HeaderLink4"></a><a name = "HeaderLink4"></a><a name = "HeaderLink4"></a>Sky</h3>
<p>The <a class="el" href="../Engine%20Reference/a01088.html">Sky</a> object renders the outside sky and cloud layers and maintains the visible distance and fog distance settings for the world. The sky also tracks vertical fog layers and installs them into the SceneGraph for rendering.</p>
<h3><a class="anchor" name="Render3DMegaTerrain"></a><a name = "HeaderLink5"></a><a name = "HeaderLink5"></a><a name = "HeaderLink5"></a>MegaTerrains</h3>
<a class="el" href="../Engine%20Reference/a01141.html">TerrainBlock</a> manages multiple 512x512 blocks of heightfield terrain, and stitches them together when appropriate. Terrain heightfield data is stored and loaded using the <a class="el" href="../Engine%20Reference/a01146.html">TerrainFile</a> resource class (Resource&lt;TerrainFile&gt;) so that a single terrain data file can be shared between server and client, when both are on the same execution instance.
<p>The terrain is textured by blending base material textures into a series of clipmap based render textures, and then transferred to the video card by the clipmap texturing system for optimized performance.</p>
<h3><a class="anchor" name="Render3DWater"></a><a name = "HeaderLink6"></a><a name = "HeaderLink6"></a><a name = "HeaderLink6"></a>Waterblocks</h3>
<p>The <a class="el" href="../Engine%20Reference/a01242.html">WaterBlock</a> class manages multiple blocks of water, using shaders to dynamically alter the texture in accordance with user defined material properties.</p>
<h3><a class="anchor" name="Render3DShapeReplicator"></a><a name = "HeaderLink7"></a><a name = "HeaderLink7"></a><a name = "HeaderLink7"></a>Shape Replication</h3>
<p>Torque provides for a network optimized method of placing large amounts of shapes in your game world called Shape Replicators, which allow you to define properties to control the frequency, coverage, type, and variations of shapes throughout your game world. Instead of having to manually place each object (and then network each object individually when playing), you define coverage areas and the rest is done randomly (with determinism, so once you get a random coverage you like, you can keep it!)</p>
<h3><a class="anchor" name="Render3DGroundClutter"></a><a name = "HeaderLink8"></a><a name = "HeaderLink8"></a><a name = "HeaderLink8"></a>Ground Cover</h3>
<p>TGE-A 1.7 introduces a brand new way to decorate your scene--Ground Cover! Ground Cover can be considered "advanced foilage replication", and acts in a similar manner to Shape Replication, but focused on objects and foilage near the control object's location.</p>
<h2><a class="anchor" name="RenderInterior"></a><a name = "HeaderLink9"></a><a name = "HeaderLink9"></a><a name = "HeaderLink9"></a>Interior</h2>
The interior library (engine/interior) manages the rendering, collision and IO for interior objects. The <a class="el" href="../Engine%20Reference/a00593.html">InteriorInstance</a> SceneObject class manages a single interior. The <a class="el" href="../Engine%20Reference/a00600.html">InteriorResource</a> class manages the data associated with one definition of an interior, multiple instances of which may exist at any one time. Interiors manage zones for the scene graph, and may have subobjects that, for example, render a mirrored view (<a class="el" href="../Engine%20Reference/a00704.html">MirrorSubObject</a>). The <a class="el" href="../Engine%20Reference/a00595.html">InteriorLMManager</a> class manages lightmaps for all currently loaded interiors - sharing lightmaps among instances where possible.
<p>
Interiors are converted to DIF by the tool Map2DIF (formerly known as Morian), or by utilizing the GarageGames Torque Constructor CSG modeling application. The source files are just Quake-style .map files - lists of convex physical "brushes" that define the solid areas of the interior. Special brushes are used to define zone portal boundaries and objects such as doors and platforms.
<h2><a class="anchor" name="Render3Space"></a><a name = "HeaderLink10"></a><a name = "HeaderLink10"></a><a name = "HeaderLink10"></a>3Space (TS)</h2>
The 3Space library (engine/ts) manages the display and animation of shape models in the world. The 3Space shape resource class <a class="el" href="../Engine%20Reference/a01184.html" title="TSShape stores generic data for a 3space model.">TSShape</a> can be shared between multiple <a class="el" href="../Engine%20Reference/a01195.html" title="An instance of a 3space shape.">TSShapeInstance</a> instances. The TSShape class manages all the static data for a shape - mesh data, animation keyframes, material lists, decal information, triggers and detail levels (for dynamically detailed shapes).
<p>
The TSShapeInstance class manages animation, rendering and detail selection for an instance of a shape. The TSShapeInstance class uses the <a class="el" href="../Engine%20Reference/a01207.html" title="3space animation thread.">TSThread</a> class to manage one of the concurrently running animations on an instance. TSShapeInstance::addThread() initializes a new thread on a shape instance, and TSShapeInstance::setSequence() sets an animation sequence for a given thread. Each thread can be individually advanced in time, or can be set on a time scale that is used when all threads are advanced in TSShapeInstance::advanceTime(). A thread can also manage transitions between sequences with TSShapeInstance::transitionToSequence().
<p>TSShape animation sequences can be composed of node/bone animation (for example, joints in an explosion), material animation (a texture animation on an explosion) and mesh animation (a morphing blob - note most mesh animations can be accomplished with node scale and rotation animations). Animations can also contain visibility tracks so that some meshes in the shape are not visible until an animation is played.   
<h2><a class="anchor" name="SimDB"></a><a name = "HeaderLink11"></a><a name = "HeaderLink11"></a><a name = "HeaderLink11"></a>Container Database</h2>
<a class="el" href="../Engine%20Reference/a00186.html">Container</a> maintains a database on both client and server for objects positioned in the simulation. It supports a set of functions for quickly inserting, removing and moving objects in the world (Container::addObject, Container::removeObject, Container::checkBins), as well as query functions for line, box and polyhedron intersection tests (Container::castRay, Container::collideBox, Container::findObjects). </td>
</td>
</tr>
</table>

</div>
<div class="footer">   <span class="copy">&copy; <a href="http://www.garagegames.com/">GarageGames.com</a></span>   <a href="../../content_welcome.html" target="">Home</a>   <a href="#">Back to Top</a></div></body>

<!-- Mirrored from docs.garagegames.com/tgea/official/content/documentation/Engine Overview/Scene3D.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 06 Dec 2017 21:36:10 GMT -->
</html>